
1. Struktura aplikacji i obrazy kontenerÃ³w
2. Manifesty Kubernetes (YAML) 
3. Konfiguracja komunikacji miÄ™dzy usÅ‚ugami
4. SposÃ³b uruchamiania i testowania 

Prosta aplikach aapche php mariadb



projekt/
 â”œâ”€â”€ web/
 â”‚    â””â”€â”€ index.php
 â””â”€â”€ Dockerfile


Tworzenie obrazu dla aplikacji na podstawie Dockerfile

SprawdÅº, czy Docker Desktop i Kubernetes uÅ¼ywajÄ… tego samego kontekstu
# docker context ls

docker context ls              
NAME            DESCRIPTION                               DOCKER ENDPOINT                             ERROR
default *       Current DOCKER_HOST based configuration   npipe:////./pipe/docker_engine
desktop-linux   Docker Desktop                            npipe:////./pipe/dockerDesktopLinuxEngine

Uzywany kontekst zaznaczony jest *

Zmiana kontekstu na defautl:
# docker context use default

Teraz tworzymy obraz

# docker build -t webapp:latest .


Manifesty

projekt/k8s/
 â”œâ”€â”€ secret.yaml   # Secret z hasÅ‚em do bazy
 â”œâ”€â”€ mariadb.yaml
 â””â”€â”€ web.yaml


Uruchamianie manifestÃ³w

# kubectl apply -f secret.yaml
# kubectl get secrets

wynik:
mariadb-secret   Opaque   1   ...

# kubectl apply -f mariadb.yaml
# kubectl get pods

NAME                       READY   STATUS    RESTARTS   AGE
mariadb-694687f59c-zvk54   1/1     Running   0          10m

PrzeglÄ…danie logÃ³w poda

# kubectl logs deployment/mariadb


Uruchomienie aplikach web 
# kubectl apply -f .\web.yaml

Restartowanie poda web

# kubectl delete pod -l app=web


Co dalej

MoÅ¼emy teraz:
ğŸ‘‰ dodaÄ‡ PersistentVolume dla MariaDB,
ğŸ‘‰ dodaÄ‡ ConfigMap dla konfiguracji PHP,
ğŸ‘‰ dodaÄ‡ Ingress, Å¼eby nie uÅ¼ywaÄ‡ NodePort,
ğŸ‘‰ rozwinÄ…Ä‡ aplikacjÄ™ o kolejne pliki PHP.